version: "3.4"

services:
  9kmmrbot:
    build:
      context: .
      dockerfile: ./Dockerfile
    env_file: .env
    restart: unless-stopped
    command: ["node", "-r", "source-map-support/register",  "dist/index.js"]
    ports: 
      - 3000:3000
    depends_on: 
      - mongodb
  mongodb:
    image: "docker.io/bitnami/mongodb:4.4-debian-10"
    restart: unless-stopped
    ports: 
      - 27017:27017
    volumes:
      - "mongodb_data:/bitnami/mongodb"
      - ./init_mongo.js:/docker-entrypoint-initdb.d/init_mongo.js

volumes:
  mongodb_data: